---
import type { Movie, Provider } from "@data/tmdb";
import FormattedDate from "./FormattedDate.astro";

interface Props {
	movie: Movie | null | undefined;
}

const { movie } = Astro.props;

const movieImageUrl = movie?.poster_path
	? `https://image.tmdb.org/t/p/w500${movie?.poster_path}`
	: "";
---


{movie && (
<article class="movie-card">
  <img class="movie-card-image" width="300" src={movieImageUrl} alt={movie.title} />
  <section class="movie-card-details">
    <section class="movie-card-details-meta">
      <FormattedDate date={new Date(movie.release_date)} />
      <span>{movie.runtime} minutes</span>
    </section>
    <h2>{movie.title}</h2>
    <section class="movie-card-details-meta">
      {movie.genres.map(
        (genre: { name: string; }) => (<span>{genre.name}</span>)
      )}
    </section>
  <section>
    <div style="display: flex; gap: .5rem;">
      {movie.providers !== undefined 
        && movie.providers.map((provider: Provider) => (
        <img 
          width="36" 
          src={`https://image.tmdb.org/t/p/w500${provider.logo_path}`} 
          alt={provider.provider_name} title={provider.provider_name} />
      ))}
    </div>
  </section>
  <p>{movie.tagline}</p>
  <p>{movie.overview}</p>
  {movie.imdb_id && (
    <a href={`https://imdb.com/title/${movie.imdb_id}`}>
      <img src="/imdb.svg" alt={`IMDB link to ${movie.title}`} />
    </a>
  )}
  </section>
</article>
)}

<style>
    .movie-card {
    min-width: 100%;
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    justify-content: center;
		background: black;
    border-radius: 2rem;
    color: white;
    padding: 1rem;
    box-sizing: border-box;
  }
  
  .movie-card-details-meta {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    font-size: .85rem;
    font-weight: 600;
    font-variant: small-caps;
    margin-bottom: 1rem;
    width: 100%;
  }
  
  .movie-card .movie-card-image {
    aspect-ratio: 2 / 3;
    flex: 1 3 160px;
    height: fit-content;
    width: 200px;
		border-radius: 1rem;
  }
  
  .movie-card .movie-card-details {
    flex:  3 2 300px;
    max-width: 600px;
  }
  
  .movie-card h2 {
    font-size: 3rem;
    margin: 0;
    line-height: 1;
  }
</style>
